# –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. **Google OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
   - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω NextAuth.js v5 —Å Google –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–∏–±—Ä–∏–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (OAuth + email/password)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ Google

2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏**
   - –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω—É–∂–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö (dashboard, editor, create)
   - –°–∫—Ä—ã—Ç–∞ –Ω–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö –∏ –ø—Ä–µ–≤—å—é
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

3. **–ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤ —á–µ—Ä–µ–∑ middleware**
   - Dashboard –∑–∞—â–∏—â–µ–Ω –∏ —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º returnTo

4. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ OAuth –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–º–æ–¥–µ–ª—å Account)
   - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π passwordHash –¥–ª—è OAuth –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è name, image, emailVerified

## üîÑ –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **NextAuth.js v5** —Å database strategy (—Å–µ—Å—Å–∏–∏ –≤ –ë–î)
- **Legacy —Å–∏—Å—Ç–µ–º–∞** (email/password —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ —Å–µ—Å—Å–∏—è–º–∏) –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: `getCurrentUser()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–µ —Å–∏—Å—Ç–µ–º—ã

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- NextAuth —Å–µ—Å—Å–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `Session` (—á–µ—Ä–µ–∑ Prisma Adapter)
- Legacy —Å–µ—Å—Å–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `Session` —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º
- Cookies: NextAuth –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–∏ cookies, legacy –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `lb_session`

### Middleware/Guards
- Middleware –∑–∞—â–∏—â–∞–µ—Ç `/dashboard` —Ä–æ—É—Ç
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∫ NextAuth, —Ç–∞–∫ –∏ legacy —Å–µ—Å—Å–∏–∏
- –†–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ `/auth/login?returnTo=...` –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üí° –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –î–≤–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (NextAuth + legacy)
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**: 
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ NextAuth
- –£–¥–∞–ª–∏—Ç—å legacy —Å–∏—Å—Ç–µ–º—É –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏
- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞: –µ–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –º–µ–Ω—å—à–µ –∫–æ–¥–∞, –ª—É—á—à–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 2. Refresh —Ç–æ–∫–µ–Ω—ã
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: NextAuth —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–µ—Å—Å–∏—è–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (TTL 30 –¥–Ω–µ–π)
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
- NextAuth —É–∂–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–µ—Å—Å–∏–π
- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é "Remember me" —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º TTL
- –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å refresh token –º–µ—Ö–∞–Ω–∏–∑–º

### 3. Rate limiting
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
```typescript
// –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è /auth/login –∏ /auth/register
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Ç–∏–ø–∞ @upstash/ratelimit –∏–ª–∏ Redis
```

### 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É `/auth/forgot-password`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VerificationToken –º–æ–¥–µ–ª—å –∏–∑ NextAuth
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å email —Å —Ç–æ–∫–µ–Ω–æ–º –¥–ª—è —Å–±—Ä–æ—Å–∞

### 5. Email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ü–æ–ª–µ `emailVerified` –µ—Å—Ç—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º –¥–æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NextAuth VerificationToken

### 6. –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA)
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é 2FA –¥–ª—è –≤–∞–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Ç–∏–ø–∞ `speakeasy` –∏–ª–∏ `otplib`
- –•—Ä–∞–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ

### 7. –£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ë–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ NextAuth
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
- ‚úÖ CSRF –∑–∞—â–∏—Ç–∞ (—É–∂–µ –µ—Å—Ç—å –≤ NextAuth)
- ‚úÖ Secure cookies (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –¥–ª—è production)
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞

### 8. –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ Google
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å GitHub OAuth (–ø–æ–ø—É–ª—è—Ä–Ω–æ —Å—Ä–µ–¥–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)
- –î–æ–±–∞–≤–∏—Ç—å Apple Sign In (–¥–ª—è iOS –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ NextAuth providers

### 9. –£–ª—É—á—à–µ–Ω–∏–µ UX
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è)
- –î–æ–±–∞–≤–∏—Ç—å "Remember me" —á–µ–∫–±–æ–∫—Å
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥

### 10. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–µ/–Ω–µ—É—Å–ø–µ—à–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ú–µ—Ç—Ä–∏–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π, –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üöÄ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

1. **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**:
   - Rate limiting (–∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞)
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
   - Email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

2. **–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**:
   - –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –£–ª—É—á—à–µ–Ω–∏–µ UX
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã OAuth

3. **–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**:
   - 2FA
   - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## üìù –ó–∞–º–µ—Ç–∫–∏

- NextAuth v5 –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ beta, –Ω–æ —Å—Ç–∞–±–∏–ª–µ–Ω –¥–ª—è production
- –¢–µ–∫—É—â–∞—è –≥–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –∫–æ–¥
- –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ —á–∏—Å—Ç—ã–π NextAuth —É–ø—Ä–æ—Å—Ç–∏—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É
- –í—Å–µ —É–ª—É—á—à–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä—è—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –±–µ–∑ breaking changes

